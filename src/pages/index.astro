---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getPosts } from '../utils/getPosts.js';
import { YouTube } from '@astro-community/astro-embed-youtube';
import { getRadioSong } from '../utils/getRadioSong'

const allPosts = getPosts();
const pageTitle = "El espacio picho de EdMateo";
const pageDescription = "Este sitio es el refugio personal de un tal Mateo, donde comparte basura y sus vivencias.";
const radioSong = await getRadioSong();
---
<BaseLayout pageTitle={pageTitle} pageDescription={pageDescription}>
    <p>
        Este sitio solo tiene una función: ser el "refugio" personal de <a href="/about">un tal Mateo</a>. A pesar de esto, su código fuente está abierto a todo el mundo en 
        <a href="https://github.com/ImnotEdMateo/website/" target="_blank" rel="noopener noreferrer">este repositorio en GitHub</a>.
    </p>

    <section>
        <h2>Posts recientes</h2>
        <ul>
            {allPosts.slice(0, 4).map(post => (
                <li key={post.slug}>
                    [{post.pubDate ? new Date(post.pubDate).toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' }) : 'No hay fecha'}] - 
                    <a href={`/post/${post.slug}`}>{post.title}</a>
                </li>
            ))}
        </ul>
    </section>

    <section>
      <h2>Actualizaciones</h2>
        <ul>
            <li>[02/06/2024] - Oficialmente, Google ya indexó mi sitio en su motor de búsqueda.</li>
            <li>[04/05/2024] - El sitio se ha adaptado a pantallas pequeñas.</li>
            <li>[01/05/2024] - Se ha reescrito toda la página en AstroJS.</li>
        </ul>
    </section>

    <section>
      <h2>Radio</h2>
      {radioSong ? (
      <p>Reproduciendo: {radioSong}</p>
      ) : (
      <p>Tal vez no se está reproduciendo nada.</p>
      )}
      <audio controls="">
        <source src="https://radio.edmateo.site/stream" type="audio/mp3">
      </audio>
    </section>

    <section>
      <h2>¿Cómo?</h2>
      <YouTube id="https://youtu.be/Z9Q3iB-K2kY?si=bIXG1z8V4JA3K6TG" />
    </section>
</BaseLayout>
